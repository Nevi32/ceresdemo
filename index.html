<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CERES AI Analysis | Farmer F007 (Daniel Mutua)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Space Grotesk', sans-serif; background-color: #fafafa; color: #0f172a; }
        .glass-panel { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(20px); border: 1px solid rgba(226, 232, 240, 0.8); }
        .curved { border-radius: 1.5rem; }
        .curved-xl { border-radius: 2rem; }
        .curved-2xl { border-radius: 2.5rem; }
        .animate-enter { animation: enter 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards; opacity: 0; transform: translateY(20px); }
        @keyframes enter { to { opacity: 1; transform: translateY(0); } }
        .stagger-1 { animation-delay: 0.1s; }
        .stagger-2 { animation-delay: 0.2s; }
        .stagger-3 { animation-delay: 0.3s; }
        .stagger-4 { animation-delay: 0.4s; }
        .stagger-5 { animation-delay: 0.5s; }
        
        .confidence-gauge { position: relative; width: 120px; height: 120px; }
        .confidence-gauge svg { transform: rotate(-90deg); }
        .gauge-bg { fill: none; stroke: #e2e8f0; stroke-width: 8; }
        .gauge-fill { fill: none; stroke: #0f172a; stroke-width: 8; stroke-linecap: round; transition: stroke-dashoffset 1s ease; }
        
        .metric-card { transition: all 0.3s ease; }
        .metric-card:hover { transform: translateY(-2px); box-shadow: 0 10px 30px -10px rgba(0,0,0,0.1); }
        
        .data-quality-badge { display: inline-flex; align-items: center; gap: 4px; font-size: 0.65rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; padding: 2px 6px; border-radius: 4px; }
        .badge-calculated { background: #dbeafe; color: #1e40af; }
        .badge-proxy-low { background: #dcfce7; color: #166534; }
        .badge-proxy-med { background: #fef3c7; color: #92400e; }
        .badge-proxy-high { background: #fee2e2; color: #991b1b; }
        .badge-gap { background: #f1f5f9; color: #64748b; border: 1px dashed #cbd5e1; }
        
        .formula-box { background: #f8fafc; border-left: 3px solid #0f172a; padding: 12px; font-family: 'Courier New', monospace; font-size: 0.85rem; margin: 8px 0; }
        .uncertainty-range { color: #64748b; font-size: 0.85em; font-weight: 400; }
        
        #pdf-loading { display: none; position: fixed; inset: 0; background: rgba(255,255,255,0.9); z-index: 50; backdrop-filter: blur(4px); }
        .spinner { width: 40px; height: 40px; border: 4px solid #e2e8f0; border-top-color: #0f172a; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        .variance-bar { height: 4px; background: #e2e8f0; border-radius: 2px; overflow: hidden; position: relative; }
        .variance-fill { height: 100%; background: #0f172a; border-radius: 2px; }
    </style>
</head>
<body class="antialiased min-h-screen p-4 md:p-8">

    <div id="pdf-loading" class="flex items-center justify-center flex-col gap-4">
        <div class="spinner"></div>
        <p class="text-slate-600 font-medium">Generating CERES Analysis Report...</p>
    </div>

    <div class="max-w-7xl mx-auto space-y-6">
        
        <!-- AI Analysis Header -->
        <header class="animate-enter glass-panel curved-2xl p-8 md:p-10 shadow-sm border-t-4 border-slate-900">
            <div class="flex flex-col lg:flex-row lg:items-center justify-between gap-8">
                <div class="flex items-start gap-6">
                    <div class="w-24 h-24 rounded-full bg-slate-900 flex flex-col items-center justify-center text-white font-bold text-2xl shrink-0">
                        <span>DM</span>
                        <span class="text-[10px] font-normal opacity-70 mt-1">F007</span>
                    </div>
                    <div class="space-y-3">
                        <div class="flex flex-wrap items-center gap-3">
                            <h1 class="text-4xl md:text-5xl font-bold tracking-tight text-slate-900">Daniel Mutua</h1>
                            <span class="px-3 py-1 bg-slate-100 border border-slate-200 text-slate-600 text-xs font-mono rounded-full">CERES AI ANALYSIS</span>
                            <span class="px-3 py-1 bg-emerald-50 text-emerald-700 border border-emerald-200 text-xs font-semibold rounded-full flex items-center gap-1.5">
                                <span class="w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse"></span>
                                87% CONFIDENCE
                            </span>
                        </div>
                        <div class="flex flex-wrap gap-4 text-sm text-slate-600">
                            <span class="flex items-center gap-1.5"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2"/></svg>ID: 254-755-778-899</span>
                            <span class="w-1 h-1 bg-slate-300 rounded-full"></span>
                            <span>Male, 41 Years</span>
                            <span class="w-1 h-1 bg-slate-300 rounded-full"></span>
                            <span class="flex items-center gap-1.5"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/></svg>Machakos Region</span>
                        </div>
                        <div class="flex items-center gap-4 pt-2">
                            <div class="text-xs text-slate-500">
                                <span class="font-semibold text-slate-700">Consensus Score:</span> 78%
                            </div>
                            <div class="text-xs text-slate-500">
                                <span class="font-semibold text-slate-700">Analyst Variance:</span> 15%
                            </div>
                            <div class="text-xs text-slate-500">
                                <span class="font-semibold text-slate-700">Records:</span> 30
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex flex-col items-end gap-3">
                    <div class="confidence-gauge">
                        <svg viewBox="0 0 100 100" class="w-full h-full">
                            <circle class="gauge-bg" cx="50" cy="50" r="42"/>
                            <circle class="gauge-fill" cx="50" cy="50" r="42" 
                                    stroke-dasharray="264" 
                                    stroke-dashoffset="34" 
                                    style="stroke: #0f172a;"/>
                        </svg>
                        <div class="absolute inset-0 flex flex-col items-center justify-center">
                            <span class="text-2xl font-bold text-slate-900">84%</span>
                            <span class="text-[10px] text-slate-500 uppercase tracking-wider">Reliability</span>
                        </div>
                    </div>
                    <button onclick="generatePDF()" class="px-6 py-3 bg-slate-900 text-white rounded-full text-sm font-medium hover:bg-slate-800 transition-colors shadow-lg flex items-center gap-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
                        Export Analysis (PDF)
                    </button>
                </div>
            </div>
        </header>

        <!-- Consensus Metrics & Variance -->
        <div class="animate-enter stagger-1 grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="glass-panel curved-xl p-6 border-l-4 border-emerald-500">
                <div class="flex justify-between items-start mb-3">
                    <div>
                        <p class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-1">Average Confidence</p>
                        <p class="text-3xl font-bold text-slate-900">87%</p>
                    </div>
                    <span class="data-quality-badge badge-calculated">High</span>
                </div>
                <p class="text-xs text-slate-600">Council-wide agreement on core facts</p>
            </div>

            <div class="glass-panel curved-xl p-6 border-l-4 border-amber-500">
                <div class="flex justify-between items-start mb-3">
                    <div>
                        <p class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-1">Inter-Analyst Variance</p>
                        <p class="text-3xl font-bold text-slate-900">15%</p>
                    </div>
                    <span class="data-quality-badge badge-proxy-med">Medium</span>
                </div>
                <div class="variance-bar mt-2">
                    <div class="variance-fill bg-amber-500" style="width: 15%;"></div>
                </div>
                <p class="text-xs text-slate-600 mt-2">Uncertainty in proxy calculations</p>
            </div>

            <div class="glass-panel curved-xl p-6 border-l-4 border-slate-900 bg-slate-900 text-white">
                <div class="flex justify-between items-start mb-3">
                    <div>
                        <p class="text-xs font-semibold text-slate-300 uppercase tracking-wider mb-1">Calculated Net Cash Flow</p>
                        <p class="text-3xl font-bold">$290<span class="text-lg text-slate-400 font-normal">/mo</span></p>
                    </div>
                    <span class="px-2 py-1 bg-white/10 rounded text-[10px] border border-white/20">±$15</span>
                </div>
                <p class="text-xs text-slate-300">Derived from income - expenses</p>
            </div>
        </div>

        <!-- Core Demographics & Financial -->
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            <div class="animate-enter stagger-2 lg:col-span-5 glass-panel curved-2xl p-8">
                <h3 class="text-lg font-bold mb-6 flex items-center gap-2">
                    <svg class="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
                    Council Consensus Data
                </h3>
                
                <div class="space-y-4">
                    <div class="flex justify-between items-center py-3 border-b border-slate-100">
                        <span class="text-slate-600 text-sm">Farmer ID</span>
                        <span class="font-mono font-semibold text-slate-900 text-sm">F007</span>
                    </div>
                    <div class="flex justify-between items-center py-3 border-b border-slate-100">
                        <span class="text-slate-600 text-sm">Primary Livestock</span>
                        <span class="font-semibold text-slate-900 text-sm">Sheep & Goats</span>
                    </div>
                    <div class="flex justify-between items-center py-3 border-b border-slate-100">
                        <span class="text-slate-600 text-sm">Farm Size</span>
                        <span class="font-semibold text-slate-900 text-sm">15 acres</span>
                    </div>
                    <div class="flex justify-between items-center py-3 border-b border-slate-100">
                        <span class="text-slate-600 text-sm">Years Farming</span>
                        <span class="font-semibold text-slate-900 text-sm">14 years</span>
                    </div>
                    <div class="flex justify-between items-center py-3 border-b border-slate-100">
                        <span class="text-slate-600 text-sm">Monthly Income</span>
                        <div class="text-right">
                            <span class="font-bold text-slate-900">$720</span>
                            <span class="uncertainty-range block text-xs">± $36 (5% CI)</span>
                        </div>
                    </div>
                    <div class="flex justify-between items-center py-3 border-b border-slate-100">
                        <span class="text-slate-600 text-sm">Monthly Expenses</span>
                        <div class="text-right">
                            <span class="font-bold text-slate-900">$430</span>
                            <span class="uncertainty-range block text-xs">± $22 (5% CI)</span>
                        </div>
                    </div>
                    <div class="flex justify-between items-center py-3">
                        <span class="text-slate-600 text-sm">Outstanding Loans</span>
                        <div class="text-right">
                            <span class="font-bold text-slate-900">$1,100</span>
                            <span class="uncertainty-range block text-xs">± $55 (5% CI)</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Calculated Analytics -->
            <div class="animate-enter stagger-3 lg:col-span-7 glass-panel curved-2xl p-8">
                <h3 class="text-lg font-bold mb-6 flex items-center gap-2">
                    <svg class="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"/></svg>
                    Calculated Analytics
                    <span class="data-quality-badge badge-calculated ml-2">Calculated</span>
                </h3>

                <div class="space-y-6">
                    <!-- Cash Flow -->
                    <div class="bg-slate-50 rounded-xl p-5 border border-slate-200">
                        <div class="flex justify-between items-start mb-3">
                            <div>
                                <p class="text-sm font-medium text-slate-900 mb-1">Net Cash Flow (Monthly)</p>
                                <p class="text-2xl font-bold text-emerald-700">$290 <span class="text-sm font-normal text-slate-500">± $15</span></p>
                            </div>
                            <div class="text-right text-xs text-slate-500">
                                <p>High Confidence</p>
                                <p>Direct Calculation</p>
                            </div>
                        </div>
                        <div class="formula-box text-slate-700">
                            Net Cash Flow = Monthly Income - Monthly Expenses<br>
                            $720 - $430 = $290 USD
                        </div>
                    </div>

                    <!-- DTI -->
                    <div class="bg-slate-50 rounded-xl p-5 border border-slate-200">
                        <div class="flex justify-between items-start mb-3">
                            <div>
                                <p class="text-sm font-medium text-slate-900 mb-1">Debt-to-Income Ratio (Annual)</p>
                                <p class="text-2xl font-bold text-slate-900">12.7% <span class="text-sm font-normal text-slate-500">± 0.6%</span></p>
                            </div>
                            <div class="text-right text-xs text-slate-500">
                                <p>Low Risk</p>
                                <p>Standard Proxy</p>
                            </div>
                        </div>
                        <div class="formula-box text-slate-700 text-xs">
                            DTI = Outstanding Loans / Annual Income<br>
                            Annual Income = $720 × 12 = $8,640<br>
                            $1,100 / $8,640 = 0.127 (12.7%)
                        </div>
                    </div>

                    <!-- Production Metrics -->
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-slate-50 rounded-xl p-4 border border-slate-200">
                            <p class="text-xs text-slate-500 uppercase mb-1">Production per Acre</p>
                            <p class="text-xl font-bold text-slate-900">$120 <span class="text-xs font-normal text-slate-500">± $6</span></p>
                            <p class="text-[10px] text-slate-400 mt-1">$1,800 / 15 acres</p>
                        </div>
                        <div class="bg-slate-50 rounded-xl p-4 border border-slate-200">
                            <p class="text-xs text-slate-500 uppercase mb-1">Manure per Acre</p>
                            <p class="text-xl font-bold text-slate-900">15.3 <span class="text-xs font-normal text-slate-500">± 0.8 kg</span></p>
                            <p class="text-[10px] text-slate-400 mt-1">230kg / 15 acres</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Livestock Profile L007 -->
        <div class="animate-enter stagger-4 glass-panel curved-2xl p-8">
            <div class="flex flex-col md:flex-row md:items-center justify-between mb-8 gap-4">
                <div>
                    <div class="flex items-center gap-3 mb-2">
                        <h2 class="text-2xl font-bold">Livestock Analysis: L007</h2>
                        <span class="px-3 py-1 bg-slate-900 text-white text-xs font-bold rounded-full">SAMPLE RECORD</span>
                    </div>
                    <p class="text-slate-500">Dorper Sheep • 4 Years • Machakos Region</p>
                </div>
                <div class="flex gap-3">
                    <div class="text-right">
                        <p class="text-sm text-slate-400">Annual Production Value</p>
                        <p class="text-2xl font-bold text-slate-900">$1,800 <span class="text-sm font-normal text-slate-500">± $90</span></p>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-emerald-50 border border-emerald-200 curved-xl p-5">
                    <div class="flex items-center gap-2 mb-3">
                        <span class="w-2 h-2 bg-emerald-500 rounded-full"></span>
                        <span class="text-xs font-semibold text-emerald-700 uppercase">Health Status</span>
                    </div>
                    <p class="text-2xl font-bold text-emerald-900 mb-1">Healthy</p>
                    <p class="text-sm text-emerald-700">Vaccination: Up-to-date</p>
                    <p class="text-xs text-emerald-600 mt-2">Last Visit: Jan 22, 2025</p>
                </div>

                <div class="bg-slate-50 border border-slate-200 curved-xl p-5">
                    <div class="flex items-center gap-2 mb-3">
                        <span class="text-xs font-semibold text-slate-500 uppercase">Monthly Manure</span>
                    </div>
                    <p class="text-2xl font-bold text-slate-900 mb-1">230 <span class="text-lg text-slate-500">kg</span></p>
                    <p class="text-sm text-slate-500">± 12kg (5% CI)</p>
                </div>

                <div class="bg-amber-50 border border-amber-200 curved-xl p-5 relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-20 h-20 bg-amber-100 rounded-full -mr-10 -mt-10 opacity-50"></div>
                    <div class="flex items-center gap-2 mb-3">
                        <span class="text-xs font-semibold text-amber-700 uppercase">Data Quality Alert</span>
                    </div>
                    <p class="text-sm font-bold text-amber-900 mb-2">Missing Breed Risk Data</p>
                    <p class="text-xs text-amber-800">Dorper risk parameters not in Breed DB. Using proxies.</p>
                </div>
            </div>

            <!-- Data Gaps Warning -->
            <div class="bg-red-50 border border-red-200 rounded-xl p-5 mb-6">
                <h4 class="font-bold text-red-900 mb-3 flex items-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/></svg>
                    Critical Data Gaps Identified
                </h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                    <div class="space-y-2">
                        <div class="flex items-start gap-2">
                            <span class="data-quality-badge badge-gap mt-0.5">GAP</span>
                            <span class="text-red-900">Risk Level for Dorper breed</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="data-quality-badge badge-gap mt-0.5">GAP</span>
                            <span class="text-red-900">Mortality Rate (%)</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="data-quality-badge badge-gap mt-0.5">GAP</span>
                            <span class="text-red-900">Productivity Impact (%)</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="data-quality-badge badge-gap mt-0.5">GAP</span>
                            <span class="text-red-900">Common Diseases list</span>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <div class="flex items-start gap-2">
                            <span class="data-quality-badge badge-gap mt-0.5">GAP</span>
                            <span class="text-red-900">Average Treatment Cost</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="data-quality-badge badge-gap mt-0.5">GAP</span>
                            <span class="text-red-900">Goat-specific production data</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="data-quality-badge badge-gap mt-0.5">GAP</span>
                            <span class="text-red-900">Seasonal expense breakdown</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="data-quality-badge badge-gap mt-0.5">GAP</span>
                            <span class="text-red-900">Loan terms (interest/maturity)</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Assumptions & Proxies -->
        <div class="animate-enter stagger-5 grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div class="glass-panel curved-xl p-6">
                <h3 class="text-lg font-bold mb-4 text-slate-900">Assumptions & Proxies</h3>
                <p class="text-sm text-slate-600 mb-4">Substitute data used where gaps exist, with severity ratings:</p>
                
                <div class="space-y-3">
                    <div class="flex items-start justify-between p-3 bg-white border border-slate-200 rounded-lg">
                        <div>
                            <p class="text-sm font-semibold text-slate-900">Risk Level = "Medium"</p>
                            <p class="text-xs text-slate-500">Regional average for meat-sheep breeds</p>
                        </div>
                        <span class="data-quality-badge badge-proxy-med">PROXY – MED</span>
                    </div>
                    
                    <div class="flex items-start justify-between p-3 bg-white border border-slate-200 rounded-lg">
                        <div>
                            <p class="text-sm font-semibold text-slate-900">Mortality Rate = 5%</p>
                            <p class="text-xs text-slate-500">National livestock mortality reports</p>
                        </div>
                        <span class="data-quality-badge badge-proxy-med">PROXY – MED</span>
                    </div>
                    
                    <div class="flex items-start justify-between p-3 bg-white border border-slate-200 rounded-lg">
                        <div>
                            <p class="text-sm font-semibold text-slate-900">Productivity Impact = 10%</p>
                            <p class="text-xs text-slate-500">Extension service guidelines</p>
                        </div>
                        <span class="data-quality-badge badge-proxy-low">PROXY – LOW</span>
                    </div>
                    
                    <div class="flex items-start justify-between p-3 bg-white border border-slate-200 rounded-lg">
                        <div>
                            <p class="text-sm font-semibold text-slate-900">Common Diseases</p>
                            <p class="text-xs text-slate-500">"Foot-rot, Parasite infestation"</p>
                        </div>
                        <span class="data-quality-badge badge-proxy-low">PROXY – LOW</span>
                    </div>
                </div>
            </div>

            <div class="glass-panel curved-xl p-6">
                <h3 class="text-lg font-bold mb-4 text-slate-900">Confidence Assessment</h3>
                <div class="space-y-4">
                    <div>
                        <div class="flex justify-between mb-2">
                            <span class="text-sm font-medium text-slate-700">High Confidence (≥90%)</span>
                            <span class="text-sm font-bold text-emerald-700">Demographics, Core Financials</span>
                        </div>
                        <div class="w-full bg-slate-100 rounded-full h-2">
                            <div class="bg-emerald-500 h-2 rounded-full" style="width: 90%"></div>
                        </div>
                    </div>
                    
                    <div>
                        <div class="flex justify-between mb-2">
                            <span class="text-sm font-medium text-slate-700">Medium Confidence (70-90%)</span>
                            <span class="text-sm font-bold text-amber-700">Cash-flow Metrics, DTI Ratios</span>
                        </div>
                        <div class="w-full bg-slate-100 rounded-full h-2">
                            <div class="bg-amber-500 h-2 rounded-full" style="width: 75%"></div>
                        </div>
                    </div>
                    
                    <div>
                        <div class="flex justify-between mb-2">
                            <span class="text-sm font-medium text-slate-700">Low Confidence (<70%)</span>
                            <span class="text-sm font-bold text-red-700">Breed Risk, Goat Output</span>
                        </div>
                        <div class="w-full bg-slate-100 rounded-full h-2">
                            <div class="bg-red-500 h-2 rounded-full" style="width: 45%"></div>
                        </div>
                    </div>

                    <div class="mt-6 p-4 bg-slate-50 rounded-lg border border-slate-200">
                        <p class="text-sm text-slate-700 leading-relaxed">
                            <strong>Overall Reliability: 84%</strong> — Derived from 87% Average Confidence adjusted for 15% Inter-Analyst Variance and ~10% Data Gap proportion. Strategic decisions dependent on breed-level risk or goat contributions should be validated with field surveys.
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Methodology & Limitations -->
        <div class="glass-panel curved-xl p-8">
            <h3 class="text-lg font-bold mb-4 text-slate-900">Methodology & Limitations</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 text-sm text-slate-600">
                <div>
                    <h4 class="font-semibold text-slate-900 mb-2">Calculation Standards</h4>
                    <ul class="space-y-2 list-disc list-inside">
                        <li>Net Cash Flow assumes no other cash inflows/outflows beyond reported monthly figures</li>
                        <li>Debt-to-Income uses total outstanding balance divided by monthly income × 12</li>
                        <li>All monetary values assumed in USD unless otherwise specified</li>
                        <li>5% Confidence Intervals (CI) propagated from source data uncertainty</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold text-slate-900 mb-2">Epistemic Limitations</h4>
                    <ul class="space-y-2 list-disc list-inside">
                        <li>Calculated fields (marked †) may not reflect actual ground conditions</li>
                        <li>Proxy data marked with severity levels (Low/Medium/High uncertainty)</li>
                        <li>Absence of goat-specific records creates incomplete production picture</li>
                        <li>Seasonal variations not captured in monthly aggregates</li>
                    </ul>
                </div>
            </div>
            <div class="mt-6 pt-6 border-t border-slate-200 text-xs text-slate-500 font-mono">
                Generated: 2026-01-30T11:18:02.299Z | CERES AI Analysis Council | 30 Records Analyzed | Consensus Score: 78%
            </div>
        </div>

        <footer class="text-center text-slate-400 text-sm py-8 pb-12">
            <p class="mb-2">CERES AI Analysis Report • Farmer F007 • Daniel Mutua</p>
            <p class="text-xs">Confidential • Derived metrics calculated from available data • Verify before strategic decisions</p>
        </footer>
    </div>

    <script>
        // PDF Generation adapted for CERES report structure
        async function generatePDF() {
            const loading = document.getElementById('pdf-loading');
            loading.style.display = 'flex';
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            const slate900 = [15, 23, 42];
            const emerald700 = [4, 120, 87];
            const amber700 = [180, 83, 9];
            const red700 = [185, 28, 28];
            
            // Header
            doc.setFillColor(...slate900);
            doc.rect(0, 0, 210, 35, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(20);
            doc.text('CERES AI ANALYSIS REPORT', 15, 20);
            doc.setFontSize(11);
            doc.setFont('helvetica', 'normal');
            doc.text('Farmer F007 – Daniel Mutua • Machakos Region', 15, 28);
            
            let y = 45;
            
            // Executive Summary
            doc.setTextColor(...slate900);
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(14);
            doc.text('Executive Summary', 15, y);
            y += 8;
            
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(10);
            const summary = "CERES AI Council analysis of Farmer F007 (Daniel Mutua) indicates a financially stable smallholder operation with moderate confidence (87%). Key findings: Positive monthly cash flow of $290 (40.3% margin), low debt burden (12.7% DTI), and healthy Dorper sheep stock. Critical data gaps exist in breed-specific risk parameters and goat production records. Overall reliability score: 84%.";
            const splitSummary = doc.splitTextToSize(summary, 180);
            doc.text(splitSummary, 15, y);
            y += splitSummary.length * 5 + 5;
            
            // Consensus Metrics
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(12);
            doc.text('Consensus Metrics', 15, y);
            y += 6;
            
            doc.autoTable({
                startY: y,
                body: [
                    ['Average Confidence', '87%', 'High agreement on core facts'],
                    ['Inter-Analyst Variance', '15%', 'Uncertainty in proxy calculations'],
                    ['Consensus Score', '78%', 'Council-wide agreement'],
                    ['Overall Reliability', '84%', 'Adjusted for gaps and variance']
                ],
                theme: 'grid',
                headStyles: { fillColor: slate900, textColor: 255, fontStyle: 'bold' },
                bodyStyles: { textColor: slate900, fontSize: 10 },
                columnStyles: {
                    0: { fontStyle: 'bold', cellWidth: 60 },
                    1: { cellWidth: 30 },
                    2: { cellWidth: 90 }
                },
                margin: { left: 15, right: 15 }
            });
            
            y = doc.lastAutoTable.finalY + 10;
            
            // Demographics
            if (y > 250) { doc.addPage(); y = 20; }
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(12);
            doc.text('1. Demographics & Financials', 15, y);
            y += 6;
            
            doc.autoTable({
                startY: y,
                head: [['Field', 'Value', 'Uncertainty']],
                body: [
                    ['Full Name', 'Daniel Mutua', '-'],
                    ['Age / Gender', '41 / Male', '-'],
                    ['National ID', '254-755-778-899', '-'],
                    ['Region', 'Machakos', '-'],
                    ['Farm Size', '15 acres', '-'],
                    ['Years Farming', '14 years', '-'],
                    ['Primary Livestock', 'Sheep & Goats', 'Missing goat records'],
                    ['Monthly Income', '$720', '± $36 (5% CI)'],
                    ['Monthly Expenses', '$430', '± $22 (5% CI)'],
                    ['Outstanding Loans', '$1,100', '± $55 (5% CI)']
                ],
                theme: 'grid',
                headStyles: { fillColor: slate900, textColor: 255 },
                bodyStyles: { textColor: slate900, fontSize: 10 },
                alternateRowStyles: { fillColor: [248, 250, 252] },
                margin: { left: 15, right: 15 }
            });
            
            y = doc.lastAutoTable.finalY + 10;
            
            // Calculated Analytics
            if (y > 220) { doc.addPage(); y = 20; }
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(12);
            doc.text('2. Calculated Analytics', 15, y);
            y += 6;
            
            doc.autoTable({
                startY: y,
                head: [['Metric', 'Formula', 'Result', 'Confidence']],
                body: [
                    ['Net Cash Flow', 'Income - Expenses', '$290 ± $15/mo', 'High'],
                    ['Debt-to-Income', 'Loans / (Income × 12)', '12.7% ± 0.6%', 'High'],
                    ['Production/Acre', '$1,800 / 15 acres', '$120 ± $6/acre', 'Medium'],
                    ['Manure/Acre', '230kg / 15 acres', '15.3 ± 0.8 kg/acre', 'Medium']
                ],
                theme: 'grid',
                headStyles: { fillColor: slate900, textColor: 255 },
                bodyStyles: { textColor: slate900, fontSize: 10 },
                columnStyles: {
                    0: { fontStyle: 'bold' },
                    1: { fontSize: 9, fontStyle: 'italic' }
                },
                margin: { left: 15, right: 15 }
            });
            
            y = doc.lastAutoTable.finalY + 10;
            
            // Livestock
            if (y > 230) { doc.addPage(); y = 20; }
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(12);
            doc.text('3. Livestock Asset: L007 (Dorper Sheep)', 15, y);
            y += 6;
            
            doc.autoTable({
                startY: y,
                body: [
                    ['Animal ID', 'L007'],
                    ['Breed', 'Dorper'],
                    ['Age', '4 years'],
                    ['Health Status', 'Healthy (Up-to-date vaccination)'],
                    ['Last Vet Visit', '2025-01-22'],
                    ['Annual Production Value', '$1,800 ± $90'],
                    ['Monthly Manure', '230 ± 12 kg'],
                    ['Daily Milk Yield', '0 L (meat sheep)']
                ],
                theme: 'grid',
                headStyles: { fillColor: [241, 245, 249], textColor: slate900, fontStyle: 'bold' },
                bodyStyles: { textColor: slate900, fontSize: 10 },
                margin: { left: 15, right: 15 }
            });
            
            y = doc.lastAutoTable.finalY + 10;
            
            // Data Gaps
            if (y > 240) { doc.addPage(); y = 20; }
            doc.setTextColor(...red700);
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(12);
            doc.text('4. Critical Data Gaps', 15, y);
            y += 6;
            doc.setTextColor(...slate900);
            doc.setFont('helvetica', 'normal');
            
            doc.autoTable({
                startY: y,
                head: [['Missing Field', 'Impact']],
                body: [
                    ['Dorper Risk Level', 'Limits risk assessment for herd health'],
                    ['Mortality Rate (%)', 'Hinders mortality forecasting'],
                    ['Productivity Impact (%)', 'Affects production efficiency projection'],
                    ['Common Diseases (Dorper)', 'Reduces preventive planning ability'],
                    ['Treatment Cost (USD)', 'Impairs cost-of-care estimation'],
                    ['Goat-specific records', 'Incomplete total farm output picture'],
                    ['Seasonal expense breakdown', 'Prevents seasonality analysis'],
                    ['Loan terms (interest/maturity)', 'Limits debt-service projection']
                ],
                theme: 'grid',
                headStyles: { fillColor: [254, 226, 226], textColor: red700 },
                bodyStyles: { textColor: slate900, fontSize: 9 },
                margin: { left: 15, right: 15 }
            });
            
            y = doc.lastAutoTable.finalY + 10;
            
            // Assumptions
            if (y > 240) { doc.addPage(); y = 20; }
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(12);
            doc.text('5. Assumptions & Proxies', 15, y);
            y += 6;
            
            doc.autoTable({
                startY: y,
                head: [['Proxy/Assumption', 'Source', 'Severity']],
                body: [
                    ['Risk Level = Medium', 'Regional meat-sheep averages', 'MEDIUM'],
                    ['Mortality Rate = 5%', 'National livestock reports', 'MEDIUM'],
                    ['Productivity Impact = 10%', 'Extension service guidelines', 'LOW'],
                    ['Common Diseases list', 'Veterinary surveillance data', 'LOW'],
                    ['Treatment Cost = $45', 'Ministry of Agriculture tables', 'LOW'],
                    ['Goat contribution = $0', 'Absence of records', 'HIGH']
                ],
                theme: 'grid',
                headStyles: { fillColor: [254, 243, 199], textColor: amber700 },
                bodyStyles: { textColor: slate900, fontSize: 10 },
                columnStyles: {
                    2: { fontStyle: 'bold', halign: 'center' }
                },
                margin: { left: 15, right: 15 }
            });
            
            y = doc.lastAutoTable.finalY + 15;
            
            // Footer
            if (y > 270) { doc.addPage(); y = 20; }
            doc.setFontSize(9);
            doc.setTextColor(150, 150, 150);
            doc.text('Methodology: All derived metrics marked with † are calculated from available data. Proxies marked with severity levels convey epistemic uncertainty.', 15, y);
            y += 5;
            doc.text('Generated: 2026-01-30T11:18:02.299Z | CERES AI Analysis Council | 30 Records Analyzed', 15, y);
            
            // Page numbers
            const pageCount = doc.internal.getNumberOfPages();
            for (let i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                doc.setFontSize(8);
                doc.setTextColor(200, 200, 200);
                doc.text(`CERES AI Report F007 • Page ${i} of ${pageCount}`, 195, 292, { align: 'right' });
            }
            
            doc.save(`CERES_Analysis_F007_Daniel_Mutua_${new Date().toISOString().split('T')[0]}.pdf`);
            loading.style.display = 'none';
        }
    </script>
</body>
</html>
