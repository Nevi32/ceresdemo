<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Ceres | Agricultural Intelligence Platform</title>
    
    <!-- External Resources -->
    <script src="https://cdn.tailwindcss.com "></script>
    <script src="https://unpkg.com/lucide@latest "></script>
    <script src="https://unpkg.com/@lottiefiles/dotlottie-wc@0.8.11/dist/dotlottie-wc.js " type="module"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300 ;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- External CSS -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- Disable default link behavior -->
    <base target="_blank">
</head>
<body class="bg-white text-slate-950 antialiased selection:bg-slate-900 selection:text-white">

    <!-- Navigation -->
    <nav class="fixed top-0 w-full bg-white/80 backdrop-blur-xl border-b border-slate-100 z-50 px-6 py-4">
        <div class="max-w-7xl mx-auto flex items-center justify-between">
            <div class="flex items-center gap-4">
                <img src="https://res.cloudinary.com/dpymwa41m/image/upload/v1762274479/Gemini_Generated_Image_q2kbiiq2kbiiq2kb-removebg-preview_zw2pnk.png " 
                     alt="Ceres" 
                     class="h-10 w-auto object-contain grayscale contrast-125">
                <div class="h-6 w-px bg-slate-200"></div>
                <span class="font-semibold text-slate-900 tracking-tight text-xs uppercase tracking-widest">Project Ceres</span>
            </div>
            
            <div class="flex items-center gap-6">
                <button onclick="showProfilesScreen()" id="profiles-btn" class="hidden px-4 py-2 bg-slate-100 hover:bg-slate-200 rounded-lg text-xs font-semibold text-slate-700 transition-all flex items-center gap-2">
                    <i data-lucide="folder-open" class="w-4 h-4"></i>
                    Saved Profiles
                </button>
                
                <div class="hidden md:flex items-center gap-2 text-xs text-slate-400 mono">
                    <span class="w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"></span>
                    SYSTEM ONLINE
                </div>
                
                <div class="h-8 w-8 bg-slate-900 rounded-lg flex items-center justify-center text-white text-xs font-medium">
                    JD
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Container -->
    <main class="pt-20 min-h-screen relative">
        
        <!-- STEP 1: Welcome Interface -->
        <div id="welcome-screen" class="fade-in min-h-[90vh] flex flex-col items-center justify-center relative overflow-hidden bg-slate-50">
            <!-- Background Elements -->
            <div class="absolute top-1/4 left-1/4 w-96 h-96 bg-blue-500/5 blur-3xl rounded-full animate-pulse"></div>
            <div class="absolute bottom-1/4 right-1/4 w-[500px] h-[500px] bg-amber-500/5 blur-3xl animate-pulse" style="animation-delay: 1s;"></div>
            
            <div class="relative z-10 text-center max-w-4xl mx-auto px-6">
                <!-- Large Logo -->
                <div class="mb-12 transform scale-125 drop-shadow-2xl">
                    <img src="https://res.cloudinary.com/dpymwa41m/image/upload/v1762274479/Gemini_Generated_Image_q2kbiiq2kbiiq2kb-removebg-preview_zw2pnk.png " 
                         alt="Ceres" 
                         class="h-72 w-auto object-contain mx-auto">
                </div>
                
                <div class="inline-flex items-center gap-2 px-4 py-2 bg-white rounded-full text-xs font-semibold uppercase tracking-wider text-slate-600 border border-slate-200 mb-8">
                    <span class="w-1.5 h-1.5 bg-blue-500 rounded-full animate-pulse"></span>
                    Agricultural Intelligence Platform
                </div>
                
                <h1 class="text-7xl md:text-8xl font-black tracking-tighter mb-6 leading-none bg-gradient-to-r from-slate-900 via-blue-900 to-slate-900 bg-clip-text text-transparent">
                    CERES
                    <span class="block text-base md:text-lg font-normal tracking-widest text-slate-500 mt-4 font-light uppercase">
                        KYF & KYL Profiling System
                    </span>
                </h1>
                
                <p class="text-slate-600 text-xl max-w-2xl mx-auto mb-16 leading-relaxed">
                    Unified data acquisition and intelligence platform for comprehensive farmer profiling, 
                    livestock analytics, and risk assessment.
                </p>
                
                <button onclick="initializeSystem()" 
                        class="btn-primary group bg-slate-900 text-white px-12 py-5 rounded-full text-sm font-semibold tracking-widest uppercase flex items-center gap-3 mx-auto hover:shadow-2xl transform hover:scale-105">
                    <span>Launch System</span>
                    <i data-lucide="arrow-right" class="w-5 h-5 group-hover:translate-x-1 transition-transform"></i>
                </button>
                
                <div class="mt-20 grid grid-cols-3 gap-12 max-w-2xl mx-auto text-center">
                    <div class="space-y-3">
                        <div class="text-3xl font-light text-slate-900">01</div>
                        <div class="text-xs text-slate-500 uppercase tracking-widest font-semibold">Data Capture</div>
                        <p class="text-xs text-slate-400">Farmer & livestock registry</p>
                    </div>
                    <div class="space-y-3">
                        <div class="text-3xl font-light text-slate-900">02</div>
                        <div class="text-xs text-slate-500 uppercase tracking-widest font-semibold">Analysis Engine</div>
                        <p class="text-xs text-slate-400">AI-driven profiling</p>
                    </div>
                    <div class="space-y-3">
                        <div class="text-3xl font-light text-slate-900">03</div>
                        <div class="text-xs text-slate-500 uppercase tracking-widest font-semibold">Risk Intelligence</div>
                        <p class="text-xs text-slate-400">Comprehensive assessment</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- STEP 2: System Initialization -->
        <div id="loading-screen" class="hidden fixed inset-0 bg-white z-50 flex flex-col items-center justify-center">
            <div class="text-center max-w-md mx-auto px-8">
                <div class="w-80 h-80 mx-auto mb-8">
                    <dotlottie-wc 
                        src="https://lottie.host/fe8f74b1-ae89-480b-aa21-b6640248b594/6vvDDa6rei.lottie " 
                        loop
                        autoplay>
                    </dotlottie-wc>
                </div>
                
                <div class="space-y-2 mb-8">
                    <h3 class="text-2xl font-bold text-slate-900 tracking-tight">Initializing Analytics Engine</h3>
                    <p class="text-slate-500" id="loading-text">Loading modules...</p>
                </div>
                
                <div class="w-full h-2 bg-slate-100 rounded-full overflow-hidden">
                    <div class="h-full bg-slate-900 w-0 transition-all duration-[2500ms] ease-out" id="loading-bar"></div>
                </div>
            </div>
        </div>

        <!-- STEP 3: Data Acquisition Workspace -->
        <div id="workspace-screen" class="hidden slide-up max-w-7xl mx-auto px-6 py-12 pb-32">
            <!-- Header with Progress -->
            <div class="mb-12 flex flex-col md:flex-row md:items-end justify-between gap-6 border-b border-slate-100 pb-8">
                <div>
                    <div class="flex items-center gap-3 mb-2">
                        <button onclick="resetSystem()" class="p-2 hover:bg-slate-50 rounded-lg transition-colors text-slate-400 hover:text-slate-900">
                            <i data-lucide="arrow-left" class="w-5 h-5"></i>
                        </button>
                        <span class="text-xs font-semibold text-slate-400 uppercase tracking-widest mono">Data Acquisition</span>
                    </div>
                    <h2 class="text-4xl font-bold tracking-tight text-slate-900">Farmer & Livestock Registry</h2>
                    <p class="text-slate-600 mt-2 font-light">Capture comprehensive KYF and KYL data for profiling</p>
                </div>
                
                <div class="flex items-center gap-6">
                    <div class="text-right">
                        <div class="text-xs text-slate-400 uppercase tracking-widest mb-1 font-semibold">Data Points</div>
                        <div class="text-2xl font-semibold mono text-slate-900" id="completion-percentage">0/15</div>
                    </div>
                    <div class="w-32 h-2 bg-slate-100 rounded-full overflow-hidden">
                        <div id="workspace-progress" class="progress-fill h-full bg-slate-900 w-0"></div>
                    </div>
                </div>
            </div>

            <div class="grid lg:grid-cols-12 gap-8">
                <!-- Left: Farmer Intelligence -->
                <div class="lg:col-span-7 space-y-6">
                    <!-- Farmer Profile -->
                    <div class="glass-card rounded-2xl p-8 border-l-4 border-l-blue-500">
                        <div class="flex items-center gap-4 mb-8 pb-6 border-b border-slate-100">
                            <div class="w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center text-white shadow-lg">
                                <i data-lucide="user-check" class="w-6 h-6"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-slate-900">Know Your Farmer (KYF)</h3>
                                <p class="text-sm text-slate-500">Personal and demographic intelligence</p>
                            </div>
                        </div>

                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="md:col-span-2">
                                <label class="block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2">Full Legal Name *</label>
                                <input type="text" id="farmer-name" placeholder="John Kamau Mwangi" 
                                       class="input-field w-full px-4 py-3 rounded-lg text-slate-900 placeholder:text-slate-300"
                                       oninput="calculateProgress()">
                            </div>
                            
                            <div>
                                <label class="block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2">Primary Contact</label>
                                <input type="tel" id="farmer-phone" placeholder="+254 700 123 456" 
                                       class="input-field w-full px-4 py-3 rounded-lg text-slate-900 placeholder:text-slate-300 mono">
                            </div>
                            
                            <div>
                                <label class="block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2">Email Address</label>
                                <input type="email" id="farmer-email" placeholder="farmer@email.com" 
                                       class="input-field w-full px-4 py-3 rounded-lg text-slate-900 placeholder:text-slate-300">
                            </div>

                            <div class="md:col-span-2">
                                <label class="block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2">Geographic Location</label>
                                <div class="grid grid-cols-2 gap-4">
                                    <input type="text" id="farmer-county" placeholder="County/Region" 
                                           class="input-field w-full px-4 py-3 rounded-lg text-slate-900 placeholder:text-slate-300">
                                    <input type="text" id="farmer-ward" placeholder="Ward/Location" 
                                           class="input-field w-full px-4 py-3 rounded-lg text-slate-900 placeholder:text-slate-300">
                                </div>
                            </div>

                            <div>
                                <label class="block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2">Land Assets (Acres)</label>
                                <input type="number" id="farmer-land" step="0.1" placeholder="0.0" 
                                       class="input-field w-full px-4 py-3 rounded-lg text-slate-900 placeholder:text-slate-300 mono">
                            </div>

                            <div>
                                <label class="block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2">Years in Farming</label>
                                <input type="number" id="farmer-experience" placeholder="5" 
                                       class="input-field w-full px-4 py-3 rounded-lg text-slate-900 placeholder:text-slate-300 mono">
                            </div>
                        </div>

                        <div class="mt-8 pt-6 border-t border-slate-100">
                            <label class="block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-3">Identity Verification Documents</label>
                            <div id="upload-id" class="upload-zone rounded-xl p-6 cursor-pointer" onclick="document.getElementById('file-id').click()">
                                <input type="file" id="file-id" class="hidden" accept=".pdf,.jpg,.png" onchange="handleUpload('id', this)">
                                <div id="id-placeholder" class="flex items-center gap-4">
                                    <div class="w-10 h-10 bg-slate-50 rounded-lg flex items-center justify-center">
                                        <i data-lucide="file-up" class="w-5 h-5 text-slate-400"></i>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-slate-900">Upload ID/Passport & Registration</p>
                                        <p class="text-xs text-slate-400">PDF, JPG, or PNG format</p>
                                    </div>
                                </div>
                                <div id="id-complete" class="hidden flex items-center justify-between">
                                    <div class="flex items-center gap-4">
                                        <div class="w-10 h-10 bg-slate-900 rounded-lg flex items-center justify-center">
                                            <i data-lucide="check" class="w-5 h-5 text-white"></i>
                                        </div>
                                        <div>
                                            <p class="text-sm font-medium text-slate-900" id="id-filename">document.pdf</p>
                                            <p class="text-xs text-slate-500">Identity verified</p>
                                        </div>
                                    </div>
                                    <button onclick="event.stopPropagation(); removeUpload('id')" class="p-2 hover:bg-slate-100 rounded-lg">
                                        <i data-lucide="x" class="w-4 h-4 text-slate-400"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Financial Intelligence -->
                    <div class="glass-card rounded-2xl p-8 border-l-4 border-l-green-500">
                        <div class="flex items-center gap-4 mb-8 pb-6 border-b border-slate-100">
                            <div class="w-12 h-12 bg-green-500 rounded-xl flex items-center justify-center text-white shadow-lg">
                                <i data-lucide="landmark" class="w-6 h-6"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-slate-900">Financial Intelligence</h3>
                                <p class="text-sm text-slate-500">Banking and fiscal records</p>
                            </div>
                        </div>

                        <div class="grid md:grid-cols-2 gap-6 mb-6">
                            <div>
                                <label class="block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2">Primary Bank</label>
                                <input type="text" id="farmer-bank" placeholder="Equity Bank" 
                                       class="input-field w-full px-4 py-3 rounded-lg text-slate-900 placeholder:text-slate-300">
                            </div>
                            <div>
                                <label class="block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2">Account Type</label>
                                <select id="farmer-account-type" class="input-field w-full px-4 py-3 rounded-lg text-slate-900 bg-transparent">
                                    <option value="">Select account type</option>
                                    <option value="savings">Savings</option>
                                    <option value="current">Current</option>
                                    <option value="mobile">Mobile Money</option>
                                </select>
                            </div>
                        </div>

                        <div class="upload-zone rounded-xl p-6 cursor-pointer" onclick="document.getElementById('file-bank').click()">
                            <input type="file" id="file-bank" class="hidden" accept=".pdf,.csv,.xlsx" onchange="handleUpload('bank', this)">
                            <div id="bank-placeholder" class="flex items-center gap-4">
                                <div class="w-10 h-10 bg-slate-50 rounded-lg flex items-center justify-center">
                                    <i data-lucide="sheet" class="w-5 h-5 text-slate-400"></i>
                                </div>
                                <div>
                                    <p class="text-sm font-medium text-slate-900">Bank Statements (6 months)</p>
                                    <p class="text-xs text-slate-400">PDF, CSV, or Excel format</p>
                                </div>
                            </div>
                            <div id="bank-complete" class="hidden flex items-center justify-between">
                                <div class="flex items-center gap-4">
                                    <div class="w-10 h-10 bg-green-500 rounded-lg flex items-center justify-center">
                                        <i data-lucide="check" class="w-5 h-5 text-white"></i>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-slate-900" id="bank-filename">statements.pdf</p>
                                        <p class="text-xs text-slate-500">6 months analyzed</p>
                                    </div>
                                </div>
                                <button onclick="event.stopPropagation(); removeUpload('bank')" class="p-2 hover:bg-slate-100 rounded-lg">
                                    <i data-lucide="x" class="w-4 h-4 text-slate-400"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Context Window -->
                    <div class="context-window rounded-2xl p-8">
                        <div class="flex items-center gap-4 mb-6">
                            <div class="w-12 h-12 bg-amber-500 rounded-xl flex items-center justify-center text-white">
                                <i data-lucide="brain" class="w-6 h-6"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-slate-900">AI Context Window</h3>
                                <p class="text-sm text-slate-600">Define profiling parameters for the analysis engine</p>
                            </div>
                        </div>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2">Primary Use Case</label>
                                <select id="use-case" class="input-field w-full px-4 py-3 rounded-lg text-slate-900 bg-white border border-slate-200">
                                    <option value="">Select profiling context...</option>
                                    <option value="banking">Banking & Lending</option>
                                    <option value="insurance">Insurance Assessment</option>
                                    <option value="investment">Investment Analysis</option>
                                    <option value="grant">Grant Eligibility</option>
                                    <option value="compliance">ESG Compliance</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2">Risk Tolerance</label>
                                <div class="grid grid-cols-3 gap-3">
                                    <label class="cursor-pointer">
                                        <input type="radio" name="risk" value="conservative" class="hidden peer">
                                        <div class="px-4 py-3 rounded-lg border border-slate-200 peer-checked:border-slate-900 peer-checked:bg-slate-900 peer-checked:text-white transition-all text-center text-sm">
                                            Conservative
                                        </div>
                                    </label>
                                    <label class="cursor-pointer">
                                        <input type="radio" name="risk" value="moderate" class="hidden peer" checked>
                                        <div class="px-4 py-3 rounded-lg border border-slate-200 peer-checked:border-slate-900 peer-checked:bg-slate-900 peer-checked:text-white transition-all text-center text-sm">
                                            Moderate
                                        </div>
                                    </label>
                                    <label class="cursor-pointer">
                                        <input type="radio" name="risk" value="aggressive" class="hidden peer">
                                        <div class="px-4 py-3 rounded-lg border border-slate-200 peer-checked:border-slate-900 peer-checked:bg-slate-900 peer-checked:text-white transition-all text-center text-sm">
                                            Aggressive
                                        </div>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right: Livestock Registry -->
                <div class="lg:col-span-5 space-y-6">
                    <div class="glass-card rounded-2xl p-8 bg-slate-900 text-white border-slate-800 shadow-2xl">
                        <div class="flex items-center gap-4 mb-8 pb-6 border-b border-slate-800">
                            <div class="w-12 h-12 bg-white/10 rounded-xl flex items-center justify-center">
                                <i data-lucide="database" class="w-6 h-6"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold">Know Your Livestock (KYL)</h3>
                                <p class="text-sm text-slate-400">Asset inventory and health records</p>
                            </div>
                        </div>

                        <div class="space-y-6">
                            <div>
                                <label class="block text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2">Species Classification</label>
                                <div class="grid grid-cols-2 gap-3">
                                    <label class="cursor-pointer">
                                        <input type="radio" name="species" value="dairy" class="hidden peer" onchange="calculateProgress()">
                                        <div class="px-4 py-3 rounded-lg border border-slate-700 peer-checked:border-white peer-checked:bg-white/10 transition-all text-center text-sm">
                                            ü•õ Dairy Cattle
                                        </div>
                                    </label>
                                    <label class="cursor-pointer">
                                        <input type="radio" name="species" value="beef" class="hidden peer" onchange="calculateProgress()">
                                        <div class="px-4 py-3 rounded-lg border border-slate-700 peer-checked:border-white peer-checked:bg-white/10 transition-all text-center text-sm">
                                            ü•© Beef Cattle
                                        </div>
                                    </label>
                                    <label class="cursor-pointer">
                                        <input type="radio" name="species" value="goats" class="hidden peer" onchange="calculateProgress()">
                                        <div class="px-4 py-3 rounded-lg border border-slate-700 peer-checked:border-white peer-checked:bg-white/10 transition-all text-center text-sm">
                                            üêê Goats
                                        </div>
                                    </label>
                                    <label class="cursor-pointer">
                                        <input type="radio" name="species" value="mixed" class="hidden peer" onchange="calculateProgress()">
                                        <div class="px-4 py-3 rounded-lg border border-slate-700 peer-checked:border-white peer-checked:bg-white/10 transition-all text-center text-sm">
                                            üêÑüêê Mixed Herd
                                        </div>
                                    </label>
                                </div>
                            </div>

                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2">Total Head Count</label>
                                    <input type="number" id="livestock-count" placeholder="0" oninput="calculateProgress()"
                                           class="w-full px-4 py-3 rounded-lg bg-white/5 border border-slate-700 text-white placeholder:text-slate-600 mono focus:border-white focus:outline-none transition-colors">
                                </div>
                                <div>
                                    <label class="block text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2">Breeding Stock</label>
                                    <input type="number" id="breeding-stock" placeholder="0" 
                                           class="w-full px-4 py-3 rounded-lg bg-white/5 border border-slate-700 text-white placeholder:text-slate-600 mono focus:border-white focus:outline-none transition-colors">
                                </div>
                            </div>

                            <div>
                                <label class="block text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2">Primary Breed</label>
                                <input type="text" id="primary-breed" placeholder="e.g., Friesian, Boran, Galla" 
                                       class="w-full px-4 py-3 rounded-lg bg-white/5 border border-slate-700 text-white placeholder:text-slate-600 focus:border-white focus:outline-none transition-colors">
                            </div>

                            <div>
                                <label class="block text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2">Estimated Herd Value (KES)</label>
                                <input type="number" id="herd-value" placeholder="0.00" 
                                       class="w-full px-4 py-3 rounded-lg bg-white/5 border border-slate-700 text-white placeholder:text-slate-600 mono focus:border-white focus:outline-none transition-colors">
                            </div>

                            <div class="pt-6 border-t border-slate-800">
                                <label class="block text-xs font-semibold text-slate-400 uppercase tracking-wider mb-3">Herd Records (CSV/Excel)</label>
                                <div class="border border-dashed border-slate-700 rounded-xl p-6 cursor-pointer hover:border-slate-500 transition-colors" onclick="document.getElementById('file-herd').click()">
                                    <input type="file" id="file-herd" class="hidden" accept=".csv,.xlsx,.pdf" onchange="handleUpload('herd', this)">
                                    <div id="herd-placeholder" class="text-center">
                                        <i data-lucide="upload-cloud" class="w-10 h-10 mx-auto mb-3 text-slate-600"></i>
                                        <p class="text-sm text-slate-300">Upload Herd Register & Health Logs</p>
                                        <p class="text-xs text-slate-500 mt-1">CSV, Excel, or PDF format</p>
                                    </div>
                                    <div id="herd-complete" class="hidden text-center">
                                        <div class="w-12 h-12 bg-white rounded-full flex items-center justify-center mx-auto mb-3">
                                            <i data-lucide="check" class="w-6 h-6 text-slate-900"></i>
                                        </div>
                                        <p class="text-sm text-white" id="herd-filename">herd_data.csv</p>
                                        <button onclick="event.stopPropagation(); removeUpload('herd')" class="text-xs text-slate-400 hover:text-white mt-2">Remove</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Health Monitoring -->
                    <div class="glass-card rounded-2xl p-6 border-l-4 border-l-amber-500 bg-amber-50">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center gap-3">
                                <i data-lucide="activity" class="w-5 h-5 text-amber-600"></i>
                                <span class="font-semibold text-slate-900">Health & Production Records</span>
                            </div>
                            <span class="text-xs text-slate-400 mono">OPTIONAL</span>
                        </div>
                        <div class="upload-zone rounded-lg p-4 cursor-pointer bg-white" onclick="document.getElementById('file-health').click()">
                            <input type="file" id="file-health" class="hidden" accept=".pdf,.csv" onchange="handleUpload('health', this)">
                            <div id="health-placeholder" class="flex items-center gap-3">
                                <i data-lucide="file-plus" class="w-5 h-5 text-slate-400"></i>
                                <span class="text-sm text-slate-600">Vaccination & Treatment Records</span>
                            </div>
                            <div id="health-complete" class="hidden flex items-center justify-between">
                                <div class="flex items-center gap-4">
                                    <div class="w-8 h-8 bg-amber-500 rounded-lg flex items-center justify-center">
                                        <i data-lucide="check" class="w-4 h-4 text-white"></i>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-slate-900" id="health-filename">health.pdf</p>
                                        <p class="text-xs text-slate-500">Health records uploaded</p>
                                    </div>
                                </div>
                                <button onclick="event.stopPropagation(); removeUpload('health')" class="text-xs text-amber-600 hover:text-amber-700 font-medium">Remove</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Floating Action Bar -->
            <div class="fixed bottom-8 left-1/2 -translate-x-1/2 w-full max-w-2xl px-6 z-40">
                <div class="glass-card rounded-2xl p-4 shadow-2xl border border-slate-200 flex items-center justify-between gap-4">
                    <div class="flex items-center gap-4 flex-1">
                        <div class="hidden sm:block">
                            <div class="text-xs text-slate-400 uppercase tracking-wider mb-1 font-semibold">Data Points</div>
                            <div class="text-sm font-semibold mono text-slate-900" id="data-points">0/15</div>
                        </div>
                        <div class="flex-1 h-2 bg-slate-100 rounded-full overflow-hidden">
                            <div id="bottom-progress" class="progress-fill h-full bg-slate-900 w-0"></div>
                        </div>
                    </div>
                    
                    <button onclick="proceedToAnalysis()" id="analyze-btn" disabled
                            class="bg-slate-200 text-slate-400 px-8 py-3 rounded-xl font-semibold transition-all flex items-center gap-2 whitespace-nowrap disabled:cursor-not-allowed">
                        <span>Continue to Analysis</span>
                        <i data-lucide="arrow-right" class="w-4 h-4"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- STEP 4: Analysis Configuration -->
        <div id="analysis-screen" class="hidden slide-up max-w-6xl mx-auto px-6 py-12 pb-32">
            <div class="mb-12 text-center">
                <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-slate-100 text-slate-600 text-xs font-semibold uppercase tracking-wider mb-6">
                    <i data-lucide="cpu" class="w-4 h-4"></i>
                    Analysis Configuration
                </div>
                <h2 class="text-4xl font-bold tracking-tight text-slate-900 mb-4">Build Profiling Brain</h2>
                <p class="text-slate-600 max-w-2xl mx-auto">Configure AI analysis modules and prompt engineering for comprehensive farmer profiling.</p>
            </div>

            <div class="grid md:grid-cols-2 gap-8 mb-12">
                <!-- Left: Prompt Builder -->
                <div class="prompt-builder rounded-2xl p-8">
                    <div class="flex items-center gap-4 mb-6">
                        <div class="w-12 h-12 bg-slate-900 rounded-xl flex items-center justify-center text-white">
                            <i data-lucide="code-2" class="w-6 h-6"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-slate-900">Prompt Engineering</h3>
                            <p class="text-sm text-slate-600">Customize AI analysis instructions</p>
                        </div>
                    </div>

                    <div class="space-y-4">
                        <div>
                            <label class="block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2">Primary Analysis Objective</label>
                            <select id="analysis-objective" class="input-field w-full px-4 py-3 rounded-lg text-slate-900 bg-white border border-slate-200">
                                <option value="">Select objective...</option>
                                <option value="risk">Risk Assessment</option>
                                <option value="credit">Credit Scoring</option>
                                <option value="asset">Asset Valuation</option>
                                <option value="insurance">Insurance Premium</option>
                                <option value="grant">Grant Eligibility</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2">System Prompt</label>
                            <textarea id="system-prompt" placeholder="You are an expert agricultural analyst specializing in farmer profiling..."
                                      class="input-field w-full px-4 py-3 rounded-lg text-slate-900 placeholder:text-slate-300 h-32 resize-none"
                                      rows="4">You are an expert agricultural analyst specializing in comprehensive farmer profiling. Analyze the provided KYF (Know Your Farmer) and KYL (Know Your Livestock) data to generate detailed risk assessments, asset valuations, and creditworthiness scores. Focus on data-driven insights with clear explanations.</textarea>
                        </div>

                        <div>
                            <label class="block text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2">Key Variables to Analyze</label>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center gap-3 p-3 rounded-lg border border-slate-200 bg-white cursor-pointer">
                                    <input type="checkbox" class="w-4 h-4 variable-checkbox" checked>
                                    <span class="text-sm">Income Stability</span>
                                </label>
                                <label class="flex items-center gap-3 p-3 rounded-lg border border-slate-200 bg-white cursor-pointer">
                                    <input type="checkbox" class="w-4 h-4 variable-checkbox" checked>
                                    <span class="text-sm">Asset Liquidity</span>
                                </label>
                                <label class="flex items-center gap-3 p-3 rounded-lg border border-slate-200 bg-white cursor-pointer">
                                    <input type="checkbox" class="w-4 h-4 variable-checkbox" checked>
                                    <span class="text-sm">Livestock Health</span>
                                </label>
                                <label class="flex items-center gap-3 p-3 rounded-lg border border-slate-200 bg-white cursor-pointer">
                                    <input type="checkbox" class="w-4 h-4 variable-checkbox">
                                    <span class="text-sm">Climate Risk</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right: Analysis Modules -->
                <div class="glass-card rounded-2xl p-8 border-l-4 border-l-blue-500">
                    <div class="flex items-center gap-4 mb-6">
                        <div class="w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center text-white">
                            <i data-lucide="cpu" class="w-6 h-6"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-slate-900">Analysis Modules</h3>
                            <p class="text-sm text-slate-500">Select profiling components</p>
                        </div>
                    </div>

                    <div class="space-y-4" id="modules-container">
                        <label class="flex items-start gap-4 p-4 rounded-xl border-2 border-slate-200 hover:border-slate-400 cursor-pointer transition-all bg-white analysis-card selected module-card" data-module="asset">
                            <input type="checkbox" class="hidden" checked>
                            <div class="w-6 h-6 rounded border-2 border-slate-300 flex items-center justify-center mt-0.5">
                                <svg class="w-4 h-4 text-white hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-900 mb-1">Asset Valuation Engine</h4>
                                <p class="text-sm text-slate-500">Livestock worth, equipment, land assets, collateral</p>
                            </div>
                        </label>

                        <label class="flex items-start gap-4 p-4 rounded-xl border-2 border-slate-200 hover:border-slate-400 cursor-pointer transition-all bg-white analysis-card selected module-card" data-module="risk">
                            <input type="checkbox" class="hidden" checked>
                            <div class="w-6 h-6 rounded border-2 border-slate-300 flex items-center justify-center mt-0.5">
                                <svg class="w-4 h-4 text-white hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-900 mb-1">Risk Scoring Algorithm</h4>
                                <p class="text-sm text-slate-500">Credit score, climate risks, market volatility</p>
                            </div>
                        </label>

                        <label class="flex items-start gap-4 p-4 rounded-xl border-2 border-slate-200 hover:border-slate-400 cursor-pointer transition-all bg-white analysis-card selected module-card" data-module="financial">
                            <input type="checkbox" class="hidden" checked>
                            <div class="w-6 h-6 rounded border-2 border-slate-300 flex items-center justify-center mt-0.5">
                                <svg class="w-4 h-4 text-white hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-900 mb-1">Financial Analysis Core</h4>
                                <p class="text-sm text-slate-500">Cash flow, profitability, debt-to-income ratios</p>
                            </div>
                        </label>

                        <label class="flex items-start gap-4 p-4 rounded-xl border-2 border-slate-200 hover:border-slate-400 cursor-pointer transition-all bg-white analysis-card module-card" data-module="production">
                            <input type="checkbox" class="hidden">
                            <div class="w-6 h-6 rounded border-2 border-slate-300 flex items-center justify-center mt-0.5">
                                <svg class="w-4 h-4 text-white hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-900 mb-1">Production Analytics</h4>
                                <p class="text-sm text-slate-500">Yield optimization, reproduction efficiency, growth</p>
                            </div>
                        </label>
                    </div>
                </div>
            </div>

            <div class="flex justify-between items-center max-w-4xl mx-auto">
                <button onclick="backToWorkspace()" class="px-6 py-3 rounded-xl border border-slate-200 text-slate-600 hover:bg-slate-50 transition-all flex items-center gap-2 font-semibold">
                    <i data-lucide="arrow-left" class="w-4 h-4"></i>
                    Back to Data
                </button>
                
                <button onclick="generateIntelligence()" class="bg-slate-900 text-white px-10 py-4 rounded-xl font-semibold hover:bg-slate-800 transition-all flex items-center gap-3 shadow-xl hover:shadow-2xl transform hover:-translate-y-0.5">
                    <span>Generate Profile</span>
                    <i data-lucide="sparkles" class="w-5 h-5"></i>
                </button>
            </div>
        </div>

        <!-- STEP 5: Success -->
        <div id="success-screen" class="hidden slide-up max-w-4xl mx-auto px-6 py-12 text-center">
            <div class="mb-8 relative inline-block">
                <div class="absolute inset-0 bg-green-500/10 blur-3xl rounded-full scale-150"></div>
                <div class="w-24 h-24 bg-slate-900 rounded-3xl flex items-center justify-center text-white relative shadow-2xl">
                    <i data-lucide="check-circle" class="w-12 h-12"></i>
                </div>
            </div>
            
            <h2 class="text-4xl font-black tracking-tight text-slate-900 mb-4">Intelligence Report Generated</h2>
            <p class="text-slate-600 text-lg mb-12 max-w-2xl mx-auto">Comprehensive farmer profile analysis complete. All selected modules have been processed and validated.</p>
            
            <div class="glass-card rounded-2xl p-8 mb-8 text-left border border-slate-200 shadow-xl">
                <div class="flex items-center justify-between mb-6 pb-6 border-b border-slate-100">
                    <div class="flex items-center gap-4">
                        <div class="w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center">
                            <img src="https://res.cloudinary.com/dpymwa41m/image/upload/v1762274479/Gemini_Generated_Image_q2kbiiq2kbiiq2kb-removebg-preview_zw2pnk.png " 
                                 alt="Ceres" 
                                 class="h-10 w-auto object-contain grayscale">
                        </div>
                        <div>
                            <div class="text-xs text-slate-400 uppercase tracking-widest mb-1">Profile ID</div>
                            <div class="font-mono text-xl font-bold text-slate-900" id="profile-id-display">CER-2024-8842-XF</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-xs text-slate-400 uppercase tracking-widest mb-1">Generated</div>
                        <div class="text-sm text-slate-900 font-medium" id="timestamp">Just now</div>
                    </div>
                </div>
                
                <div class="grid md:grid-cols-3 gap-8 mb-8">
                    <div class="text-center p-6 rounded-xl bg-slate-50 border border-slate-100">
                        <div class="w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4">
                            <i data-lucide="user" class="w-8 h-8 text-blue-600"></i>
                        </div>
                        <div class="text-xs text-slate-400 uppercase tracking-widest mb-2">Farmer</div>
                        <div class="font-bold text-slate-900 text-lg" id="result-farmer-name">--</div>
                        <div class="text-sm text-slate-500">Primary Account</div>
                    </div>
                    
                    <div class="text-center p-6 rounded-xl bg-amber-50 border border-amber-100">
                        <div class="w-16 h-16 bg-amber-100 rounded-2xl flex items-center justify-center mx-auto mb-4">
                            <i data-lucide="cow" class="w-8 h-8 text-amber-600"></i>
                        </div>
                        <div class="text-xs text-slate-400 uppercase tracking-widest mb-2">Livestock</div>
                        <div class="font-bold text-slate-900 text-lg" id="result-livestock-count">45 Head</div>
                        <div class="text-sm text-slate-500" id="result-livestock-type">Dairy Cattle</div>
                    </div>
                    
                    <div class="text-center p-6 rounded-xl bg-green-50 border border-green-100">
                        <div class="w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-4">
                            <i data-lucide="shield-check" class="w-8 h-8 text-green-600"></i>
                        </div>
                        <div class="text-xs text-slate-400 uppercase tracking-widest mb-2">Risk Rating</div>
                        <div class="inline-flex items-center gap-2 px-4 py-2 bg-green-100 text-green-700 rounded-full text-sm font-bold" id="risk-badge">
                            <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                            Low Risk (AA)
                        </div>
                    </div>
                </div>
                
                <div class="pt-6 border-t border-slate-100 flex items-center justify-between">
                    <div>
                        <div class="text-xs text-slate-400 uppercase tracking-widest mb-2">Total Valuation</div>
                        <div class="text-3xl font-black text-slate-900 mono" id="total-valuation">KES 4.2M</div>
                    </div>
                    <div class="flex gap-3">
                        <button onclick="startNewProfile()" class="px-6 py-3 rounded-xl border border-slate-200 text-slate-600 hover:bg-slate-50 transition-all font-semibold flex items-center gap-2">
                            <i data-lucide="plus" class="w-4 h-4"></i>
                            New Profile
                        </button>
                        <button onclick="exportProfile()" class="px-6 py-3 rounded-xl bg-slate-900 text-white hover:bg-slate-800 transition-all font-semibold flex items-center gap-2 shadow-lg">
                            <i data-lucide="download" class="w-4 h-4"></i>
                            Export Report
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="grid grid-cols-3 gap-6 max-w-2xl mx-auto">
                <div class="text-center p-4 rounded-xl bg-slate-50 border border-slate-100">
                    <div class="text-2xl font-bold text-slate-900 mb-1" id="data-points-count">15</div>
                    <div class="text-xs text-slate-500 uppercase tracking-wider font-semibold">Data Points</div>
                </div>
                <div class="text-center p-4 rounded-xl bg-slate-50 border border-slate-100">
                    <div class="text-2xl font-bold text-slate-900 mb-1" id="modules-count">4</div>
                    <div class="text-xs text-slate-500 uppercase tracking-wider font-semibold">AI Modules</div>
                </div>
                <div class="text-center p-4 rounded-xl bg-slate-50 border border-slate-100">
                    <div class="text-2xl font-bold text-slate-900 mb-1" id="confidence-score">98%</div>
                    <div class="text-xs text-slate-500 uppercase tracking-wider font-semibold">Confidence</div>
                </div>
            </div>
        </div>

        <!-- STEP 6: Past Profiles Screen -->
        <div id="profiles-screen" class="hidden slide-up max-w-7xl mx-auto px-6 py-12 pb-32">
            <div class="mb-12 flex items-end justify-between gap-6 border-b border-slate-100 pb-8">
                <div>
                    <div class="flex items-center gap-3 mb-2">
                        <button onclick="hideProfilesScreen()" class="p-2 hover:bg-slate-50 rounded-lg transition-colors text-slate-400 hover:text-slate-900">
                            <i data-lucide="arrow-left" class="w-5 h-5"></i>
                        </button>
                        <span class="text-xs font-semibold text-slate-400 uppercase tracking-widest mono">Archive</span>
                    </div>
                    <h2 class="text-4xl font-bold tracking-tight text-slate-900">Saved Profiles</h2>
                    <p class="text-slate-600 mt-2 font-light">View and manage previously generated farmer profiles</p>
                </div>
                
                <div class="text-right">
                    <div class="text-xs text-slate-400 uppercase tracking-widest mb-1 font-semibold">Total Profiles</div>
                    <div class="text-2xl font-semibold mono text-slate-900" id="total-profiles">0</div>
                </div>
            </div>

            <div id="profiles-empty" class="text-center py-20 hidden">
                <div class="w-24 h-24 bg-slate-50 rounded-2xl flex items-center justify-center mx-auto mb-6">
                    <i data-lucide="folder-open" class="w-12 h-12 text-slate-300"></i>
                </div>
                <h3 class="text-xl font-semibold text-slate-900 mb-2">No Profiles Yet</h3>
                <p class="text-slate-500 max-w-md mx-auto mb-6">Your saved farmer profiles will appear here once you generate them.</p>
                <button onclick="hideProfilesScreen()" class="bg-slate-900 text-white px-6 py-3 rounded-xl font-semibold hover:bg-slate-800 transition-all">
                    Create First Profile
                </button>
            </div>

            <div id="profiles-list" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Profile cards will be dynamically inserted here -->
            </div>
        </div>

    </main>

    <script src="app.js"></script>
</body>
</html>
